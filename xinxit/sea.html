<!DOCTYPE html>
<html lang="en">

<head>
    <title>公海</title>
    <!-- Bootstrap -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
    <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">
    <!-- <link href="vendors/easypiechart/jquery.easy-pie-chart.css" rel="stylesheet" media="screen"> -->
    <link href="css/styles.css" rel="stylesheet" media="screen">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/polling.css">
    <!-- <script src="vendors/modernizr-2.6.2-respond-1.1.0.min.js"></script> -->
    <link rel="stylesheet" type="text/css" href="themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="themes/icon.css">
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/datagrid-filter.js"></script>
    <script type="text/javascript" src="https://www.jeasyui.com/easyui/datagrid-cellediting.js"></script>
    <link rel="stylesheet" href="css/table.css">
    <link rel="stylesheet" href="css/studentcontract.css">
    <script src="My97DatePicker/My97DatePicker/WdatePicker.js"></script>
    <style>
        .hidd>div,
        .hidd1>div,
        .hidd2>div,
        .hidd3>div,
        .hidd4>div,
        .hidd5>div,
        .hidd6>div,
        .hidd7>div,
        .hidd8>div,
        .hidd9>div,
        .hidd10>div,
        .hidd11>div,
        .hidd12>div {
            float: left;
            width: 25%;
            text-align: center
        }

        .p50 {
            width: 50%;
            float: left;
            padding: 10px 0;
        }

        .p100 {
            width: 100%;
            float: left;
        }

        .hidda1>div,
        .hidda2>div,
        .hidda3>div,
        .hidda4>div {
            width: 50%;
            float: left;
        }

        #seaform>.span6 {
            margin-top: 10px;
        }

        #seaform>div>input {
            margin: 0;
        }

        .hidd3>div,
        .hidd4>div,
        .hidd6>div,
        .hidd7>div,
        .hidd8>div,
        .hidd9>div,
        .hidd10>div,
        .hidd11>div,
        .hidd12>div {
            width: 33%;
        }

        .hidd5>div {
            width: 50%;
        }

        #seaform>div>div>input {
            width: 60%;
            height: 30px;
        }

        #seaform>div>div {
            margin: 0;
        }

        #seaform>div>div>select {
            width: 62%;
            height: 40px;
        }

        #seaform>div>div>span {
            display: inline-block;
            width: 30%;
        }

        #polling-header-body {
            padding: 0;
        }

        .seaformp1,
        .seaformp2,
        .seaformp3 {
            background-repeat: no-repeat;
            background-position-x: 99%;
            background-position-y: 50%;
        }

        #seaform>div>input,
        #seaform1>div>input {
            width: 60%;
            height: 30px;
        }

        .im_table td {
            border: 1px solid rgb(204, 204, 204);
            text-align: center;
            width: 10%;
            height: 30px;
            overflow: hidden;
            overflow-x: auto;
            min-width: 100px;
            word-wrap: break-word;
            word-break: break-all;
        }
    </style>
</head>

<body>
    <div class="container-fluid">
        <div class="row-fluid">
            <!-- block -->
            <div class="block">
                <div class="span12" id="polling-header" style="overflow:inherit;">
                    <div class=" span10 " id="polling-header-top">
                        <p class="polling-headerp" style="background-image: url('img/down.svg');"><span></span>查询条件</p>
                    </div>
                    <div class=" span10 " id="polling-header-body" style="padding-bottom: 10px">
                        <form style="position:relative" name="seaform" id="seaform">
                            <div class="span6" style="position:relative;" data-ig="project">
                                <span>项目：</span><input class="" type="text" name="project" placeholder="项目">
                                <div class="hidd2"
                                    style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;消防</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                    <div style="text-align:center">
                                        <input type="checkbox" name="" id="" style="vertical-align: top;"><span
                                            style="display: inline;">&nbsp;基金</span>
                                    </div>
                                </div>
                            </div>

                            <div class="span6" style="position:relative;" data-ig="section">
                                <span>部门：</span><input class="" type="text" name="sector" placeholder="部门">
                                <div class="hidd3"
                                    style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                                </div>
                            </div>

                            <div class="span6" style="position:relative;" data-ig="group">
                                <span>小组：</span><input class="" type="text" name="group" placeholder="小组">
                                <div class="hidd4"
                                    style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                                </div>
                            </div>
                            <div class="span6" style="position:relative;">
                                <span>条件：</span>
                                <select name="" id="">
                                    <option value="未分配">未分配</option>
                                    <option value="全部">全部</option>
                                </select>
                            </div>
                            <input type="button" class="polling-allot" value="分配"
                                style="margin-right:30px;    margin-top: 10px;"></input>
                            <input type="button" class="reset" value="重置" style=" margin-top: 10px;"></input>
                            <input type="button" id="seasearch" class="seasearch" value="查询"
                                style=" margin-top: 10px;"></input>
                            <input type="button" id="seasearch" style=" margin-top: 10px;width: auto;" class="addSource"
                                value="导入" style=" margin-top: 10px;"></input>
                            <input type="button" id="seasearch" style=" margin-top: 10px;width: auto;" class="addData"
                                value="新建" style=" margin-top: 10px;"></input>
                            <input type="button" id="seasearch" style=" margin-top: 10px;width: auto;" class="addEngine"
                                value="新建引擎" style=" margin-top: 10px;"></input>

                        </form>
                    </div>
                    <div class=" span10 " id="polling-header-footer" style="display:none">
                        <div class="block-content collapse in">
                            <div class="span12">
                                <div style="overflow:auto">
                                    <table id="datagrid2" title="消防升级数据列表" style="overflow:auto"
                                        data-options="rownumbers:true,singleSelect:false,pagination:true,pageSize:10,pagelist:[20,50,100]"
                                        style="width: 100%;">
                                        <thead>
                                            <tr class="content">

                                                <th
                                                    data-options="field:'mobile',width:200,align:'center',editor:'textbox'">
                                                    手机号</th>
                                                <th data-options="field:'project',width:200,align:'center'">项目</th>
                                                <!-- <th data-options="field:'belong_to',width:170,align:'center' ">咨询师</th> -->
                                                <th data-options="field:'sign_type',width:200,align:'center' ">报名类型</th>
                                                <th data-options="field:'classType',width:220,align:'center' ">班型</th>
                                                <!-- <th data-options="field:'in_time',width:170,align:'center'">录入时间</th> -->
                                                <th
                                                    data-options="field:'sign_up_date',sortable:true,width:200,align:'center',editor:'textbox'">
                                                    报名时间</th>
                                                <!--<th data-options="field:'did',width:80,align:'center'">did</th>-->

                                            </tr>

                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="modelprompt1">
        <div class="modelcuer">
            <div class="modelcuer-head">
                <p style="color:#42b983">提示</p>
                <button class="promptx1">X</button>
            </div>
            <div class="modeldel-body">
                <div class="monumber">
                    <p class="promptp1" style="color:#42b983;"></p>
                    <button class="promptx1" style="padding:0px 30px">确定</button>
                </div>
            </div>
        </div>
    </div>
    <div class="model-work-order" style="overflow:auto">
        <div class="modelorderr" style="top:10%;    width: 100%;
            left: 0%;">
            <div class="modeldel-head">
                <p style="color:#42b983">上传表格<span style="font-size:12px"></span></p>
                <button class="work-orderx" style="">X</button>
            </div>
            <div class="modeldel-body">
                <div class="monumber"><span>表格：</span>
                    <input type="file" name="oldpwd" onchange="importf(this)">
                </div>
                <div style="max-height:350px;overflow: auto">
                    <table class="im_table" style="    border-collapse: collapse;
                border: 1px solid rgb(204,204,204);
                width: 95%;
                margin: 0 auto;
                padding: 10px;">
                        <tr>
                            <td>项目</td>
                            <td>军团</td>
                            <td>部门</td>
                            <td>小组</td>
                            <td>负责人</td>
                            <td>url</td>
                            <td>渠道</td>
                            <td>分类</td>
                            <td>广告商</td>
                            <td>套站</td>
                            <td>载体</td>
                            <td>匹配方式</td>
                            <td>地域</td>
                        </tr>
                    </table>
                </div>

                <p class="revisep" style="color:#42b983;">hehe</p>

                <button style="padding:0px 30px" class="revisewen">提交</button>
            </div>
        </div>

    </div>
    <div class="modelplc" style="">
        <div class="modelstur">
            <!-- <input type="text" name="hehe"> -->
            <div class="modelstur-head">
                <p style="color:#42b983">选择项目</p>

                <button class="xlcxx">X</button>
            </div>
            <div class="modelstu-body">
                <div class="monumber"><span>分配项目：</span>
                    <select name="xlcx_project" id="">
                        <option value="基金项目">基金项目</option>
                        <option value="消防项目">消防项目</option>
                    </select>
                    <!-- <input type="text" name="mobile"> -->
                </div>
                <p class="xlcxp" style="color:#42b983;"></p>

                <button style="padding:0px 30px" class="allot_xlcx">提交</button>
            </div>
        </div>
    </div>
    <div class="modelhistory" style="">
        <div class="modelhistoryr">
            <div class="modelhistory-head">
                <p style="color:#42b983">新建数据</p>
                <button class="historyx">X</button>
            </div>
            <div class="modelstu-body">
                <div class="monumber"><span>手机号：</span>
                    <input type="text" name="addData_mobile" style="height:20px">
                </Div>
                <div class="monumber"><span>信息：</span>
                    <input type="text" name="addData_source" style="height:20px">
                </div>
                <div class="monumber"><span>url：</span>
                    <input type="text" name="addData_url" style="height:20px">
                </div>
                <p class="historyp" style="color:#42b983;">url匹配失败</p>

                <button style="padding:0px 30px" class="addData_allot">提交</button>
            </div>
        </div>

    </div>
    <div class="modelEngine" style="display:none">
        <div class="modelhistoryr">
            <div class="modelhistory-head">
                <p style="color:#42b983">新建引擎</p>
                <button class="enginex">X</button>
            </div>
            <div class="modelstu-body">
                <div class="p50" style="position:relative;margin: 0;
                text-align: left;" data-ig="Engine_project">
                    <span style="width: 30%;
                    display: inline-block;
                    text-align: center;">项目：</span><input class="" type="text" name="Engine_project"
                        style="margin:0;width: 60%" placeholder="项目">
                    <div class="hidda1"
                        style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                    </div>
                </div>
                <div class="p50" style="position:relative;margin: 0;
                text-align: left;" data-ig="Engine_army">
                    <span style="width: 30%;
                    display: inline-block;
                    text-align: center;">军团：</span><input class="" type="text" name="Engine_army"
                        style="margin:0;width: 60%" placeholder="军团">
                    <div class="hidda2"
                        style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                    </div>
                </div>
                <div class="p50" style="position:relative;margin: 0;
                text-align: left;" data-ig="Engine_sector">
                    <span style="width: 30%;
                    display: inline-block;
                    text-align: center;">部门：</span><input class="" type="text" name="Engine_sector"
                        style="margin:0;width: 60%" placeholder="部门">
                    <div class="hidda3"
                        style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                    </div>
                </div>
                <div class="p50" style="position:relative;margin: 0;
                text-align: left;" data-ig="Engine_group">
                    <span style="width: 30%;
                    display: inline-block;
                    text-align: center;">小组：</span><input class="" type="text" name="Engine_group"
                        style="margin:0;width: 60%" placeholder="小组">
                    <div class="hidda4"
                        style="display:none;width:60%;position:absolute;top:40px;z-index:999;left:30%;background:white;border:1px solid rgb(219,219,219);border-radius:5px;padding:4px 6px">

                    </div>
                </div>
                <div class="p100" style="position:relative;margin: 0;
                text-align: left;padding: 10px 0;">
                    <span style="width: 15%;
                    display: inline-block;
                    text-align: center;">匹配规则：</span><input class="" type="text" name="rule"
                        style="margin:0;width: 80%" placeholder="例如A,B,C,D,A">
                </div>
                <div class="p100" style="position:relative;margin: 0;
               padding: 10px 0;">
                    <p class="enginep" style="color:#42b983;"></p>

                    <button style="padding:0px 30px" class="addEngine_allot">提交</button>
                </div>

            </div>
        </div>

    </div>
    <div class="modelplc" style="">
        <form class="modeldelr" id="simple1" enctype="multipart/form-data">
            <div class="modeldel-head">
                <p style="color:#42b983">上传退费截图</p>
                <!--<input typle ></input>-->
                <input type="button" name="" id="" value="X" class="plcx"
                    style=" position:absolute;top: 0;right: 0;width: 50px;height: 50px;color: white;background: #42b983;border: none;border-radius: 2px;">
            </div>
            <div class="modeldel-body">
                <!--<div class="monumber"><span>昵称：</span>
                    <input type="text" name="simplename" placeholder="请输入昵称">
                  </div>-->
                <div class="monumber"><span>头像：</span>
                    <input type="file" name="tuifeijt">
                </div>
                <p class="tuifeip" style="color:#42b983;"></p>
                <button style="padding:0px 30px" type="button" class="tuifeigo">保存</button>
            </div>
        </form>

    </div>
</body>
<script src="js/xlcx.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://www.jeasyui.com/easyui/jquery.edatagrid.js"></script>
<script type="text/javascript" src="https://www.jeasyui.com/easyui/datagrid-cellediting.js"></script>
<script type="text/javascript">
    $('.addData').click(function () {
        $('.modelhistory').css('display', 'block')
    })

    //新建引擎
    $('.addEngine').click(function () {
        $('.modelEngine').css('display', 'block')
    })
    $('.enginex').click(function () {
        $('.modelEngine').css('display', 'none')
    })
    var Engine = [{
                "gid": 1,
                "gname": "消防项目",
                "type": "3",
                "fid": 0
            },
            {
                "gid": 5,
                "gname": "基金项目",
                "type": "3",
                "fid": 0
            },
            {
                "gid": 2,
                "gname": "消防第一军团",
                "type": "8",
                "fid": 1
            },
            {
                "gid": 3,
                "gname": "消防一部",
                "type": "2",
                "fid": 2
            },
            {
                "gid": 10,
                "gname": "消防一部",
                "type": "2",
                "fid": 2
            },
            {
                "gid": 4,
                "gname": "消防一组",
                "type": "1",
                "fid": 3
            },
            {
                "gid": 6,
                "gname": "基金一军团",
                "type": "1",
                "fid": 5
            },
            {
                "gid": 7,
                "gname": "基金一部",
                "type": "1",
                "fid": 6
            },
            {
                "gid": 8,
                "gname": "基金一组",
                "type": "1",
                "fid": 7
            }
        ],
        Engine_project = [],
        Engine_army_str = [],
        Engine_army = [],
        Engine_sector_str = [],
        Engine_sector = [],
        Engine_group_str = [],
        Engine_group = []
    for (let i = 0; i < Engine.length; i++) {
        if (Engine[i].fid == '0') {
            Engine_project.push(Engine[i])
        }

    }
    console.log(Engine_project)
    $('.hidda1')[0].innerHTML = ''
    for (let i = 0; i < Engine_project.length; i++) {
        $('.hidda1')[0].innerHTML +=
            `<div style="text-align:center">
                                                <input type="checkbox" name="" id="" style="vertical-align: top;" data-id=` +
            Engine_project[i].gid + `><span style="display: inline;">&nbsp;` +
            Engine_project[i].gname + `</span>
                                            </div>`

    }

    //引擎项目
    $(document).click(function (e) {
        if ($(e.target.parentElement).attr('data-ig') == "Engine_project" || $(e.target.parentElement
                .parentElement).attr('data-ig') == "Engine_project" || $(e.target.parentElement.parentElement
                .parentElement).attr('data-ig') == "Engine_project") {
            $('.hidda1')[0].style.display = "block"
        } else {
            var hhh = $('input[name = Engine_project]')[0].value;
            $('.hidda1')[0].style.display = "none";
            $('input[name = Engine_project]').val('');
            Engine_army_str = []
            $('.hidda1 input[type=checkbox]').each(function (index, el) {
                if (el.checked == true) {
                    console.log($(el).attr('data-id'))
                    Engine_army_str.push($(el).attr('data-id'))
                    $('input[name = Engine_project]')[0].value += '+' + el.nextElementSibling.innerHTML
                        .split(';')[1]
                }
            })

            $('input[name = Engine_project]')[0].value = $('input[name = Engine_project]')[0].value.substring(1)
            if (hhh != $('input[name = Engine_project]')[0].value) {
                $('.hidda2')[0].innerHTML = ''
                for (let j = 0; j < Engine_army_str.length; j++) {
                    for (let i = 0; i < Engine.length; i++) {
                        if (Engine_army_str[j] == Engine[i].fid) {
                            $('.hidda2')[0].innerHTML +=
                                `<div style="text-align:center">
                                                            <input type="checkbox" name="" id="" style="vertical-align: top;" data-id=` +
                                Engine[i].gid + `><span style="display: inline;">&nbsp;` +
                                Engine[i].gname + `</span>
                                                        </div>`
                        }


                    }
                }
            }
        }
    })
    //引擎军团
    $(document).click(function (e) {
        console.log(e.target.parentElement)
        if ($(e.target.parentElement).attr('data-ig') == "Engine_army" || $(e.target.parentElement
                .parentElement).attr('data-ig') == "Engine_army" || $(e.target.parentElement.parentElement
                .parentElement).attr('data-ig') == "Engine_army") {
            console.log(Engine_army_str)

            $('.hidda2')[0].style.display = "block"
        } else {
            var hhh = $('input[name = Engine_army]')[0].value;
            $('.hidda2')[0].style.display = "none";
            $('input[name = Engine_army]').val('');
            Engine_sector_str = []
            $('.hidda2 input[type=checkbox]').each(function (index, el) {
                if (el.checked == true) {
                    Engine_sector_str.push($(el).attr('data-id'))
                    $('input[name = Engine_army]')[0].value += '+' + el.nextElementSibling.innerHTML
                        .split(';')[1]
                }
            })

            $('input[name = Engine_army]')[0].value = $('input[name = Engine_army]')[0].value.substring(1)
            if (hhh != $('input[name = Engine_army]')[0].value) {
                $('.hidda3')[0].innerHTML = ''
                for (let j = 0; j < Engine_sector_str.length; j++) {
                    for (let i = 0; i < Engine.length; i++) {
                        if (Engine_sector_str[j] == Engine[i].fid) {
                            $('.hidda3')[0].innerHTML +=
                                `<div style="text-align:center">
                                                                <input type="checkbox" name="" id="" style="vertical-align: top;" data-id=` +
                                Engine[i].gid + `><span style="display: inline;">&nbsp;` +
                                Engine[i].gname + `</span>
                                                            </div>`
                        }


                    }
                }
            }

        }
    })
    //引擎部门
    $(document).click(function (e) {
        if ($(e.target.parentElement).attr('data-ig') == "Engine_sector" || $(e.target.parentElement
                .parentElement).attr('data-ig') == "Engine_sector" || $(e.target.parentElement
                .parentElement.parentElement).attr('data-ig') == "Engine_sector") {
            $('.hidda3')[0].style.display = "block"
        } else {
            hhh = $('input[name = Engine_sector]').val();
            $('.hidda3')[0].style.display = "none";
            $('input[name = Engine_sector]').val('');
            Engine_group_str = []
            $('.hidda3 input[type=checkbox]').each(function (index, el) {
                if (el.checked == true) {
                    Engine_group_str.push($(el).attr('data-id'))
                    $('input[name = Engine_sector]')[0].value += '+' + el.nextElementSibling.innerHTML
                        .split(';')[1]
                }
            })
            $('input[name = Engine_sector]')[0].value = $('input[name = Engine_sector]')[0].value.substring(1)
            if (hhh != $('input[name = Engine_sector]').val()) {
                $('.hidda4')[0].innerHTML = ''
                for (let j = 0; j < Engine_group_str.length; j++) {
                    for (let i = 0; i < Engine.length; i++) {
                        if (Engine_group_str[j] == Engine[i].fid) {
                            $('.hidda4')[0].innerHTML +=
                                `<div style="text-align:center">
                                                                <input type="checkbox" name="" id="" style="vertical-align: top;" data-id=` +
                                Engine[i].gid + `><span style="display: inline;">&nbsp;` +
                                Engine[i].gname + `</span>
                                                            </div>`
                        }


                    }
                }
            }
        }
    })
    //引擎小组
    $(document).click(function (e) {
        if ($(e.target.parentElement).attr('data-ig') == "Engine_group" || $(e.target.parentElement
                .parentElement).attr('data-ig') == "Engine_group" || $(e.target.parentElement
                .parentElement.parentElement).attr('data-ig') == "Engine_group") {

            $('.hidda4')[0].style.display = "block"
        } else {
            $('.hidda4')[0].style.display = "none";
            $('input[name = Engine_group]').val('');
            $('.hidda4 input[type=checkbox]').each(function (index, el) {
                if (el.checked == true) {
                    $('input[name = Engine_group]')[0].value += '+' + el.nextElementSibling.innerHTML
                        .split(';')[1]
                }
            })
            $('input[name = Engine_group]')[0].value = $('input[name = Engine_group]')[0].value.substring(1)
        }
    })
    $('.addEngine_allot').click(function () {
        enginer = (($('input[name = Engine_project]').val() != '' ? ',' + $('input[name = Engine_project]')
            .val() : '') +
            ($('input[name = Engine_army]').val() != '' ? ',' + $('input[name = Engine_army]').val() : '') +
            ($('input[name = Engine_sector]').val() != '' ? ',' + $('input[name = Engine_sector]').val() :
                '') +
            ($('input[name = Engine_group]').val() != '' ? ',' + $('input[name = Engine_group]').val() : '')
            ).substring(1)
        rule = $('input[name = rule]').val()
        console.log(enginer, rule)
        regRule = /^[A-Z,]{0,}$/
        console.log(regRule.test(rule))
        if (enginer.length > 2) {
            $('.enginep').text('引擎内容长度超过255字，无法提交')
            timer = setTimeout(function () {
                $('.enginep').text('')
            }, 3000)
            return
        }
        if (rule == '' || enginer == '') {
            $('.enginep').text('有内容未填写，无法提交')
            clearTimeout(timer)
            timer = setTimeout(function () {
                $('.enginep').text('')
            }, 3000)
        } else {
            if (regRule.test(rule)) {
                $.ajax({
                    url: '',
                    type: 'get',
                    data: {
                        enginer,
                        rule
                    },
                    success: function () {

                    },
                })
            } else {
                $('.enginep').text('匹配规则未按要求填写')
            }
        }

    })
    //个人信息
    $('.simplenew').click(function () {
        $('.modelplc')[1].style.display = "block"
    })
    $('.plcx').click(function () {
        $('.modelplc')[1].style.display = "none";
    })
    $("input[name=tuifeijt]").change(function () {
        var file = this.files[0];
        console.log(file.size)
        var maxsize = 1 * 1024 * 1024
        if (file.size > maxsize) {
            $('.tuifeip')[0].innerHTML = "图片尺寸超过1MB 请另选图片";
            setTimeout(function () {
                $('.tuifeip')[0].innerHTML = "";
            }, 3000);

            $('.tuifeigo').attr('disabled', 'disabled');
            return
        } else if (window.FileReader) {

            var reader = new FileReader();
            reader.readAsDataURL(file);
            //监听文件读取结束后事件    
            reader.onloadend = function (e) {
                console.log(e.target.result)
                $('.tuifeigo').attr('disabled', false); //e.target.result就是最后的路径地址
            };
        }
    });

    $('.tuifeigo').click(function () {
        var form = new FormData(document.getElementById("simple1"));
        form.set('did', 20)
        // console.log(document.getElementById("simple"))
        console.log(form)
        $.ajax({
            url: "hetong.php",
            type: "post",
            data: form,
            processData: false,
            contentType: false,
            success: function (data) {
                if (data == 1) {
                    $('.tuifeip')[0].innerHTML = "保存成功";
                } else {
                    $('.tuifeip')[0].innerHTML = "保存失败";
                }
            },
            error: function () {
                $('.tuifeip')[0].innerHTML = "服务器错误";
            }
        })
    })
    var lockMobile = false;
    var lockUrl = false;
    var urlID = 0;
    regMobile = /^1[3|4|5|6|7|8|9][0-9]{9}$/;
    $('input[name=addData_mobile]').blur(function () {
        if (regMobile.test($('input[name=addData_mobile]').val())) {
            $('.historyp').text('')
            lockMobile = true
        } else {
            $('.historyp').text('手机格式不正确')
            lockMobile = false
        }
    })
    $('input[name=addData_url]').blur(function () {
        value = $(this).val()
        if ($(this).val() != "") {
            $.ajax({
                url: '{{Url("admin/getUrlId")}}',
                type: 'post',
                data: {
                    'url': $('input[name=addData_url]').val(),
                    '_token': '{{csrf_token()}}'
                },
                success: function (data) {
                    urlID = data
                    if (data != 0) {
                        $('.historyp').text('url匹配正确')
                        urlLock = true
                    } else {
                        $('.historyp').text('url匹配失败')
                        urlLock = false
                    }
                },
                error: function () {
                    $('.historyp').text('服务器错误')
                    urlLock = false
                }
            })
        } else {
            $('.historyp').text('')
            urlLock = true
        }
    })
    $('.addData_allot').click(function () {
        if (urlLock == true && lockMobile == true && $('input[name=addData_source]').val() != "") {
            $.ajax({
                url: '',
                type: 'post',
                data: {
                    url_id: urlId,
                    url: $('input[name=addData_url]').val(),
                    mobile: $('input[name=addData_mobile]').val(),
                    education: $('input[name=addData_source]').val(),
                },
                success: function () {

                },
                error: function () {

                }
            })
        } else {
            $('.historyp').text('请正确填写信息')
        }
    })
    $('.historyx').click(function () {
        $('.modelhistory').css('display', 'none')
    })
    //导入
    var wb; //读取完成的数据
    var rABS = false; //是否将文件读取为二进制字符串
    var js;
    var obja = [];
    var enginearr = [];

    function importf(obj) { //导入
        $('.im_table')[0].innerHTML = `
            <tr>
                <td>项目</td>
                <td>军团</td>
                <td>部门</td>
                <td>小组</td>
                <td>负责人</td>
                <td>url</td>
                <td>渠道</td>
                <td>分类</td>
                <td>广告商</td>
                <td>套站</td>
                <td>载体</td>
                <td>匹配方式</td>
                <td>地域</td>
            </tr>
            `
        obja = [];
        if (!obj.files) {
            return;
        }
        var f = obj.files[0];
        var reader = new FileReader();
        reader.onload = function (e) {
            var data = e.target.result;
            if (rABS) {
                wb = XLSX.read(btoa(fixdata(data)), { //手动转化
                    type: 'base64'
                });
            } else {
                wb = XLSX.read(data, {
                    type: 'binary'
                });
            }
            console.log(wb.Sheets[wb.SheetNames[0]])
            //wb.SheetNames[0]是获取Sheets中第一个Sheet的名字
            //wb.Sheets[Sheet名]获取第一个Sheet的数据
            wb.Sheets[wb.SheetNames[0]].A1.w = "project";
            wb.Sheets[wb.SheetNames[0]].B1.w = "army";
            wb.Sheets[wb.SheetNames[0]].C1.w = "sector";
            wb.Sheets[wb.SheetNames[0]].D1.w = "group";
            wb.Sheets[wb.SheetNames[0]].E1.w = "leader";
            wb.Sheets[wb.SheetNames[0]].F1.w = "url";
            wb.Sheets[wb.SheetNames[0]].G1.w = "channel";
            wb.Sheets[wb.SheetNames[0]].H1.w = "classify";
            wb.Sheets[wb.SheetNames[0]].I1.w = "advertiser";
            wb.Sheets[wb.SheetNames[0]].J1.w = "station";
            wb.Sheets[wb.SheetNames[0]].K1.w = "carrier";
            wb.Sheets[wb.SheetNames[0]].L1.w = "matching";
            wb.Sheets[wb.SheetNames[0]].M1.w = "province";
            console.log(wb.Sheets[wb.SheetNames[0]]);
            js = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]])
            console.log(js)
            for (let i = 0; i < js.length; i++) {
                obja[i] = {};
                obja[i].project = js[i].project != undefined ? js[i].project : '';
                obja[i].army = js[i].army != undefined ? js[i].army : '';
                obja[i].sector = js[i].sector != undefined ? js[i].sector : '';
                obja[i].group = js[i].group != undefined ? js[i].group : '';
                obja[i].leader = js[i].leader != undefined ? js[i].leader : '';
                obja[i].url = js[i].url != undefined ? js[i].url : '';
                obja[i].channel = js[i].channel != undefined ? js[i].channel : '';
                obja[i].classify = js[i].classify != undefined ? js[i].classify : '';
                obja[i].advertiser = js[i].advertiser != undefined ? js[i].advertiser : '';
                obja[i].station = js[i].station != undefined ? js[i].station : '';
                obja[i].carrier = js[i].carrier != undefined ? js[i].carrier : '';
                obja[i].matching = js[i].matching != undefined ? js[i].matching : '';
                obja[i].province = js[i].province != undefined ? js[i].province : '';
                delete js[i]['__rowNum__'];
                console.log(js[i])
                // for (let j = 0; j < data.length; j++) {
                //     if(js[i].name == data[j].name && js[i].group == data[j].group){
                //         console.log(data[j].uid)
                //         obja[i].uid = data[j].uid
                //     }
                // }
            }
            console.log(obja)

            for (let k = 0; k < obja.length; k++) {
                // uid = obja[k].uid=='0'?'无效':obja[k].uid
                // if(uid == "无效"){
                $('.im_table')[0].innerHTML += `
            <tr>
                        <td style="">` + obja[k].project + `</td>
                        <td style="">` + obja[k].army + `</td>
                        <td style="">` + obja[k].sector + `</td>
                        <td style="">` + obja[k].group + `</td>
                        <td style="">` + obja[k].leader + `</td>
                        <td style=""><div style="    overflow: auto;
    height: 30px;">` + obja[k].url + `</div></td>
                        <td style="">` + obja[k].channel + `</td>
                        <td style="">` + obja[k].classify + `</td>
                        <td style="">` + obja[k].advertiser + `</td>
                        <td style="">` + obja[k].station + `</td>
                        <td style="">` + obja[k].carrier + `</td>
                        <td style="">` + obja[k].matching + `</td>
                        <td style="">` + obja[k].province + `</td>
                    </tr>
            `
                // }
                obja[k].engine = ((obja[k].project != '' ? ',' + obja[k].project : '') +
                    (obja[k].army != '' ? ',' + obja[k].army : '') +
                    (obja[k].sector != '' ? ',' + obja[k].sector : '') +
                    (obja[k].group != '' ? ',' + obja[k].group : '')).substring(1)
                delete obja[k].army;
                delete obja[k].sector;
                delete obja[k].group;
                if (enginearr.indexOf(obja[k].engine) < 0) {
                    enginearr.push(obja[k].engine)
                }
            }
            // for (let k = 0; k < obja.length; k++) {
            //     uid = obja[k].uid=='0'?'无效':obja[k].uid
            //     if(uid != "无效"){
            //         $('.im_table')[0].innerHTML+=`
            // <tr>
            //             <td>`+obja[k].name+`</td>
            //             <td>`+obja[k].group+`</td>
            //             <td>`+obja[k].class+`</td>
            //             <td>`+obja[k].time+`</td>
            //             <td>`+uid+`</td>
            //         </tr>
            // `
            //     }
            // }
        };
        if (rABS) {
            reader.readAsArrayBuffer(f);
        } else {
            reader.readAsBinaryString(f);
        }
    }

    $('.revisewen').click(function () {
        engine = "\'\"" + enginearr.join('","') + "\"\'"
        console.log(engine)
        objaa = JSON.stringify(obja);

        console.log(objaa, obja)
        $.ajax({
            url: '',
            type: 'get',
            data: {
                objaa
            },
            success: function () {

            },
            error: function () {

            }
        })
    })

    function fixdata(data) { //文件流转BinaryString
        var o = "",
            l = 0,
            w = 10240;
        for (; l < data.byteLength / w; ++l) o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w, l *
            w + w)));
        o += String.fromCharCode.apply(null, new Uint8Array(data.slice(l * w)));
        return o;
    }

    // $(function(){
    // 	$(function () {
    //         var p = $('#datagrid2').datagrid('getPager');
    //         $(p).pagination({
    //             beforePageText: '第',//页数文本框前显示的汉字  
    //             afterPageText: '页    共 {pages} 页',
    //             displayMsg: '当前: 第 {from}~{to} 条   共 {total} 条',
    //         });
    //    });
    // })

    var locktp = true;
    $('.promptx1').click(function () {
        $('.modelprompt1')[0].style.display = "none";
    })
    $('.work-orderx').click(function () {
        $('.model-work-order').css('display', 'none')
    })
    $('.addSource').click(function () {
        $('.model-work-order').css('display', 'block')
    })
    $('.polling-headerp').click(function () {
        if ($(this)[0].style.backgroundImage == 'url("{{asset("img/down.svg")}}")') {
            console.log(1)
            $(this)[0].style.backgroundImage = 'url("{{asset("img/up.svg")}}")';
            $('#polling-header-body')[0].style.display = "none"
        } else {
            $(this)[0].style.backgroundImage = 'url("{{asset("img/down.svg")}}")'
            $('#polling-header-body')[0].style.display = "block"
        }
    })
    $('.polling-allotp').click(function () {
        if ($(this)[0].style.backgroundImage == 'url("{{asset("img/down.svg")}}")') {
            console.log(1)
            $(this)[0].style.backgroundImage = 'url("{{asset("img/up.svg")}}")';
            $('#polling-allot-body')[0].style.display = "none"
        } else {
            $(this)[0].style.backgroundImage = 'url("{{asset("img/down.svg")}}")'
            $('#polling-allot-body')[0].style.display = "block"
        }
    })
    $('.reset').click(function () {
        $("#seaform").find('input[type=text],select').each(function () {
            $(this).val('');
        });
    })
    var thisApp = {
        init: function () {
            $("#datagrid2").datagrid({
                rownumbers: true,
                singleSelect: false,
                pagination: true,
                //              url:'{{Url("admin/getPublicData")}}',
                method: 'get',
                remoteSort: false,
                checkOnSelect: false,
                selectOnCheck: true,
                pageSize: 5,
                pageList: [5, 10, 20],
                queryParams: form2Json("seaform"),
                toolbar: [{
                    text: '调配',
                    iconCls: 'icon-save',
                    handler: function () {
                        $('.modelplc')[1].style.display = "block"
                        var get = $("#datagrid2").datagrid("getSelections");
                        var arr3 = []
                        for (let i = 0; i < get.length; i++)

                        {
                            arr3.push(get[i].did);
                        }
                        console.log(arr3)
                        if (arr3 != "") {
                            $.ajax({
                                url: '{{Url("admin/proviseToMyData")}}',
                                type: 'post',
                                data: {
                                    did: arr3,
                                    _token: "{{csrf_token()}}"
                                },
                                dataType: 'json',
                                success: function (data) {
                                    if (data.success == true) {
                                        $('.modelprompt1')[0].style.display =
                                            "block";
                                        $('.promptp1')[0].innerHTML = "成功" +
                                            data.successNum + "条 " + ' 失败' +
                                            data.failNum + '条';
                                    } else if (data.success == false) {
                                        $('.modelprompt1')[0].style.display =
                                            "block";
                                        $('.promptp1')[0].innerHTML = "该时段不能领取";
                                    } else {
                                        $('.modelprompt1')[0].style.display =
                                            "block";
                                        $('.promptp1')[0].innerHTML = "未知错误";
                                    }
                                },
                                error: function () {
                                    $('.modelprompt1')[0].style.display =
                                        "block";
                                    $('.promptp1')[0].innerHTML = "服务器错误";
                                }
                            })
                        }

                    }
                }],
                onSortColum: function (sort, order) { //其中sort代表排序列字段名称；order:排序列的顺序（ASC或DESC）
                    $('#datagrid2').datagrid('reload', {
                        sort: sort,
                        order: order
                    });
                },
                onLoadSuccess: function (data) {
                    lockcx = true;
                    console.log(data.rows)
                    if (data.rows.length > 0) {
                        //循环判断操作为新增的不能选择
                        for (var i = 0; i < data.rows.length; i++) {
                            //根据isFinanceExamine让某些行不可选
                            //                              if (data.rows[i].did == "") {
                            //                                  $("input[type='checkbox']")[i + 1].disabled = true;
                            //                                  $("input[type='checkbox']")[i + 1].checked = false;
                            //                              }
                        }
                    }
                    $('.datagrid-header-check').html("<input type='checkbox' id='selectAll'>");
                    console.log($('#selectAll'))
                    $('#selectAll').change(function () {
                        console.log(data3)
                        var status = $(this).is(':checked');
                        var data3 = $("#datagrid2").datagrid("getSelections");
                        if (data3 != "") {
                            $('.polling-allot').attr('disabled', false)
                        } else {
                            $('.polling-allot').attr('disabled', 'disabled')
                        }
                        $("input:checkbox[name = 'ck']").each(function (rowIndex, el) {
                            $('#datagrid2').datagrid('unselectRow', rowIndex);
                            $("input:checkbox[name = 'ck']")[rowIndex].checked =
                                false
                            if (!$(this).is(":disabled")) {
                                if (status) {
                                    $('#datagrid2').datagrid('checkRow', rowIndex);
                                }
                            }
                        })
                    })
                    var data3 = $("#datagrid2").datagrid("getSelections");
                    if (data3 != "") {
                        $('.polling-allot').attr('disabled', false)
                    } else {
                        $('.polling-allot').attr('disabled', 'disabled')
                    }
                },
                onClickRow: function (rowIndex, rowData) {
                    console.log(1)
                    if ($("input:checkbox[name = 'ck']")[rowIndex].disabled == true) {
                        $("input:checkbox[name = 'ck']")[rowIndex].checked = false;
                    } else {

                        if ($("input:checkbox[name = 'ck']")[rowIndex].checked == true) {
                            $("input:checkbox[name = 'ck']")[rowIndex].checked = false
                        } else {
                            $("input:checkbox[name = 'ck']")[rowIndex].checked = true
                        }
                    }
                    var a = 0;
                    $("input:checkbox[name = 'ck']").each(function (rowIndex, el) {

                        if (el.disabled == true) {
                            $('#datagrid2').datagrid('unselectRow', rowIndex);
                            a++;
                        }
                    })
                    var b = 0;
                    for (var i = 0; i < $("input:checkbox[name = 'ck']").length; i++) {
                        if ($("input:checkbox[name = 'ck']")[i].checked == true) {
                            b++
                        }
                    }
                    if (a == b) {
                        $('#selectAll')[0].checked = true;
                    } else {
                        $('#selectAll')[0].checked = false;
                    }
                    var data3 = $("#datagrid2").datagrid("getSelections");
                    if (data3 != "") {
                        $('.polling-allot').attr('disabled', false)
                    } else {
                        $('.polling-allot').attr('disabled', 'disabled')
                    }
                },
                onDblClickRow: function () {
                    console.log(1)
                }
            })
        }
    }


    $(function () {

        var lockcx = true
        $(".seasearch").linkbutton({
            iconCls: 'icon-search',
            plain: true
        }).click(function () {

            if (lockcx == true) {
                lockcx = false;
                thisApp.init();
                $('.panel-title').append(`
                <span class="jjsign" style="margin-left:2rem;color:red">基金：112</span>
                <span style="margin-left:2rem;color:red">消防：112</span>
            `)
                $('.jjsign').text('19990801')
                $('.polling-allot').css('display', 'none ')
                $('#polling-header-footer')[0].style.display = "block"
                var dg = $('#datagrid2').datagrid({
                    queryParams: form2Json("seaform"),
                    singleSelect: false,
                    url: 'datagrid_data3.json',
                    onLoadSuccess: function (data) {
                        lockcx = true;
                        console.log(data)
                        if (data.rows.length > 0) {
                            //循环判断操作为新增的不能选择
                            for (var i = 0; i < data.rows.length; i++) {
                                //根据isFinanceExamine让某些行不可选
                                //                              if (data.rows[i].did == "") {
                                //                                  $("input[type='checkbox']")[i + 1].disabled = true;
                                //                                  $("input[type='checkbox']")[i + 1].checked = false;
                                //                              }
                            }
                        }
                        $('.datagrid-header-check').html(
                            "<input type='checkbox' id='selectAll'>");
                        console.log($('#selectAll'))
                        $('#selectAll').change(function () {
                            console.log(data3)
                            var status = $(this).is(':checked');
                            var data3 = $("#datagrid2").datagrid("getSelections");
                            if (data3 != "") {
                                $('.polling-allot').attr('disabled', false)
                            } else {
                                $('.polling-allot').attr('disabled', 'disabled')
                            }
                            $("input:checkbox[name = 'ck']").each(function (
                                rowIndex, el) {
                                $('#datagrid2').datagrid('unselectRow',
                                    rowIndex);
                                $("input:checkbox[name = 'ck']")[rowIndex]
                                    .checked = false
                                if (!$(this).is(":disabled")) {
                                    if (status) {
                                        $('#datagrid2').datagrid('checkRow',
                                            rowIndex);
                                    }
                                }
                            })
                        })
                        var data3 = $("#datagrid2").datagrid("getSelections");
                        if (data3 != "") {
                            $('.polling-allot').attr('disabled', false)
                        } else {
                            $('.polling-allot').attr('disabled', 'disabled')
                        }
                    }
                });
                dg.datagrid('enableFilter', [{
                    field: 'mobile',
                    type: 'text'
                }, {
                    field: 'project',
                    type: 'text'
                }, {
                    field: 'sign_type',
                    type: 'text'
                }, {
                    field: 'classType',
                    type: 'text'
                }, {
                    field: 'sign_up_date',
                    type: 'text'
                }]);
                var p = $('#datagrid2').datagrid('getPager');
                $(p).pagination({
                    beforePageText: '第', //页数文本框前显示的汉字  
                    afterPageText: '页    共 {pages} 页',
                    displayMsg: '当前: 第 {from}~{to} 条   共 {total} 条',
                });
            }

        });

        function getNowFormatDate(date) {
            var seperator1 = "-";
            var seperator2 = ":";
            var month = date.getMonth() + 1;
            var strDate = date.getDate();
            var hour = date.getHours();
            var minute = date.getMinutes();
            var second = date.getSeconds();
            if (month >= 1 && month <= 9) {
                month = "0" + month;
            }
            if (strDate >= 0 && strDate <= 9) {
                strDate = "0" + strDate;
            }
            if (hour >= 0 && hour <= 9) {
                hour = "0" + hour;
            }
            if (minute >= 0 && minute <= 9) {
                minute = "0" + minute;
            }
            if (second >= 0 && second <= 9) {
                second = "0" + second;
            }
            var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate +
                " " + hour + seperator2 + minute +
                seperator2 + second;
            return currentdate;
        }
        $('.allot_xlcx').click(function () {

        })
        $('.xlcxx').click(function () {
            $('.modelplc').css('display', 'none')
        })
        $('.polling-allot').click(function () {
            var get2 = $("#datagrid2").datagrid("getSelections");
            var arr5 = []
            for (let i = 0; i < get2.length; i++) {
                obj = {}
                obj.mobile = get2[i].mobile
                obj.belong_to = $('select[name=polling-account]').val()
                obj.alloc_name = $('select[name=polling-account]').val()
                obj.project = '消防升级'
                obj.in_time = get2[i].in_time
                obj.alloc_time = getNowFormatDate(new Date())
                obj.get_time = getNowFormatDate(new Date())
                obj.next_consult_time = getNowFormatDate(new Date())
                obj.chat_history = get2[i].chat_history
                obj.data_transfer = get2[i].data_transfer
                obj.sign_times = get2[i].sign_times
                arr5.push(obj);
            }
            console.log(arr5)
            if ($('select[name=polling-account]').val() != "") {
                if (locktp == true) {
                    locktp = false
                    $.ajax({
                        url: '',
                        type: 'get',
                        data: {
                            mobile: JSON.stringify(arr5),
                            allotname: $('select[name=polling-account]').val(),
                            _token: "{{csrf_token()}}"
                        },
                        // dataType:'json',
                        success: function (data) {
                            console.log(data)
                            if (data.success == true) {
                                $('.modelprompt1')[0].style.display = "block";
                                // 	if(data.successNum==0){
                                // 		$('.promptp1')[0].innerHTML = "调配失败,该咨询师60条分配数已用完";
                                // 	}else{
                                //     	$('.promptp1')[0].innerHTML = "成功"+data.successNum+"条 "+ ' 失败'+data.failNum+'条';
                                //    }
                                thisApp.init();
                                $('#datagrid2').datagrid('enableFilter', [{
                                    field: 'mobile',
                                    type: 'text'
                                }, {
                                    field: 'project',
                                    type: 'text'
                                }, {
                                    field: 'sign_type',
                                    type: 'text'
                                }, {
                                    field: 'classType',
                                    type: 'text'
                                }, {
                                    field: 'sign_up_date',
                                    type: 'text'
                                }]);
                                var p = $('#datagrid2').datagrid('getPager');
                                $(p).pagination({
                                    beforePageText: '第', //页数文本框前显示的汉字  
                                    afterPageText: '页    共 {pages} 页',
                                    displayMsg: '当前: 第 {from}~{to} 条   共 {total} 条',
                                });
                            } else if (data.success == false) {
                                // $('.modelprompt1')[0].style.display="block";
                                // $('.promptp1')[0].innerHTML = "该时段不能分配";	            
                            } else {
                                // $('.modelprompt1')[0].style.display="block";
                                // $('.promptp1')[0].innerHTML = '已升级: '+data;	 
                                thisApp.init();
                                $('#datagrid2').datagrid('enableFilter', [{
                                    field: 'mobile',
                                    type: 'text'
                                }, {
                                    field: 'project',
                                    type: 'text'
                                }, {
                                    field: 'sign_type',
                                    type: 'text'
                                }, {
                                    field: 'classType',
                                    type: 'text'
                                }, {
                                    field: 'sign_up_date',
                                    type: 'text'
                                }]);
                                var p = $('#datagrid2').datagrid('getPager');
                                $(p).pagination({
                                    beforePageText: '第', //页数文本框前显示的汉字  
                                    afterPageText: '页    共 {pages} 页',
                                    displayMsg: '当前: 第 {from}~{to} 条   共 {total} 条',
                                });
                            }
                            locktp = true
                        },
                        error: function () {
                            $('.modelprompt1')[0].style.display = "block";
                            $('.promptp1')[0].innerHTML = "服务器错误";
                            locktp = true
                        }
                    })
                }

            } else {
                $('.modelprompt1')[0].style.display = "block";
                $('.promptp1')[0].innerHTML = "请选择姓名";
            }

        })
        // });
    })

    function form2Json(id) {

        var arr = $("#" + id).serializeArray()
        var jsonStr = "";

        jsonStr += '{';
        for (var i = 0; i < arr.length; i++) {
            jsonStr += '"' + arr[i].name + '":"' + arr[i].value + '",'
        }
        jsonStr = jsonStr.substring(0, (jsonStr.length - 1));
        jsonStr += '}'

        var json = JSON.parse(jsonStr)
        return json
    }
</script>

</html>