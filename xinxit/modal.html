<div class="modelcircul">
    <div class="modelcirculr">
      <div class="modelcircul-head">
          <p style="color:#42b983">数据流转查询</p>
          <button class="circulx">X</button>
      </div>
      <div class="modelcircul-body">
          <div class="monumber"><span>手机号：</span>
          <input type="text" name="searchnumber" placeholder="请输入手机号">
          </div>
          <button style="padding:0px 30px" class="circulgo">查询</button>
      </div>
      
      <div class="circulrcontent" style="text-align:center">
      </div>
    </div>
  
</div>
<div class="modeldel">
      <form class="modeldelr delto" method="get" action="#" onsubmit="return false;">
        <div class="modeldel-head">
            <p style="color:#42b983">账户移除</p>
            <button class="delx">X</button>
        </div>
        <div class="modeldel-body">
            <div class="monumber"><span>姓名：</span>
           <select name="delaccount" id="" style="width:62%">
              <option value="">请选择姓名</option>
              <option value="ergou">李二狗-基金一组-12306</option>
              <option value="sangou">李三狗</option>
              <option value="4gou">李四狗</option>
              <option value="dagou">李大狗</option>
              <option value="xiaow">小王</option>
              <option value="xj">小江</option>
              <option value="xwb">小王八</option>
              <option value="xwz">小王子</option>
           </select>
            </div>
            <div class="monumber"><span>搜索：</span>
              <input type="text" name="delname" placeholder="请输入咨询师正确姓名">
              </div>
      <p class="delp" style="color:#42b983;">hehe</p>
      
            <button style="padding:0px 30px" class="delwen">删除</button>
            <div class="delhid" style="margin-top:20px;display:none">
                <button class="delgo" disabled>确定</button>
                <button class="delnone" style="margin-left:50px">取消</button>
            </div>
        </div>
      </form>
    
  </div>
  <div class="modeltarget">
      <form class="modeltargetr target" method="get" onsubmit="return false;">
        <div class="modeltarget-head">
            <p style="color:#42b983">目标设定</p>
            <button class="targetx">X</button>
        </div>
        <div class="modeltarget-body">
            <div class="monumber"><span>姓名：</span>
           <select name="targetaccount" id="" style="width:62%">
               <option value="0">请选择姓名</option>
           </select>
            </div>
            <div class="monumber"><span>搜索：</span>
              <input type="text" name="targetname" placeholder="请输入咨询师正确信息">
              </div>
              <div class="monumber"><span>目标：</span>
                  <input type="text" name="targetmoney" placeholder="请输入目标">
                  </div>
      <p class="targetp" style="color:#42b983;">hehe</p>
      
                  <button style="padding:0px 30px" class="targetwen">分配</button>
                  <div class="targethid" style="margin-top:20px;display:none">
                      <button class="targetgo" disabled>确定</button>
                      <button class="targetnone" style="margin-left:50px">取消</button>
                  </div>
        </div>
      </form>
    
  </div>
  <div class="modelreset">
      <form class="modeldelr reset" action="" method="get" onsubmit="return false;">
        <div class="modeldel-head">
            <p style="color:#42b983">重置密码</p>
            <button class="resetx">X</button>
        </div>
        <div class="modeldel-body">
            <div class="monumber"><span>姓名：</span>
           <select name="resetaccount" id="" style="width:62%">
              <option value="">请选择姓名</option>
              <option value="ergou">李二狗</option>
              <option value="sangou">李三狗</option>
              <option value="4gou">李四狗</option>
              <option value="dagou">李大狗</option>
              <option value="xj">小江</option>
              <option value="xwb">小王八</option>
              <option value="xwz">小王子</option>
           </select>
            </div>
            <div class="monumber"><span>搜索：</span>
              <input type="text" name="resetname" placeholder="请输入咨询师正确信息">
              </div>
      <p class="resetp" style="color:#42b983;">hehe</p>
      
              <button style="padding:0px 30px" class="resetwen">重置</button>
              <div class="resethid" style="margin-top:20px;display:none">
                  <button class="resetgo" disabled>确定</button>
                  <button class="resetnone" style="margin-left:50px">取消</button>
              </div>
            
        </div>
      </form>
    
  </div>
  <div class="modelsimple">
      <form class="modeldelr" id="simple" action="" enctype="multipart/form-data" onsubmit="return false;">
        <div class="modeldel-head">
            <p style="color:#42b983">个人信息</p>
            <button class="simplex">X</button>
        </div>
        <div class="modeldel-body">
            <div class="monumber"><span>昵称：</span>
              <input type="text" name="simplename" placeholder="请输入昵称">
            </div>
            <div class="monumber"><span>头像：</span>
              <input type="file" name="simplehead" >
              </div>
      <p class="simplep" style="color:#42b983;"></p>
      
              <div>
                  <img class="headimg" src="" alt="" width="200px" style="height:200px;margin-bottom:20px">
              </div>
              <div class="monumber"><span>活动图：</span>
                  <input type="file" name="backimg" >
                  </div>
                  
            <button style="padding:0px 30px" type="submit" class="simplego" >保存</button>
        </div>
      </form>
    
  </div>
  <div class="modelrevise" >
      <form class="modeldelr revise" action="" method="get" onsubmit="return false;">
        <div class="modeldel-head">
            <p style="color:#42b983">修改密码</p>
            <button class="revisex">X</button>
        </div>
        <div class="modeldel-body">
            <div class="monumber"><span>姓名：</span>
              <span style="width:62%;">江山</span>
            </div>
            <div class="monumber"><span>旧密码：</span>
              <input type="text" name="oldpwd" placeholder="请输入旧密码">
              </div>
              <div class="monumber"><span>新密码：</span>
                  <input type="text" name="newpwd" placeholder="请输入新密码">
                  </div>
                  <div class="monumber"><span>确认密码：</span>
                      <input type="text" name="againnewpwd" placeholder="确认密码">
                      </div>
      <p class="revisep" style="color:#42b983;">hehe</p>
      
            <button style="padding:0px 30px" class="revisewen">提交</button>
            <div class="revisehid" style="margin-top:20px;display:none">
                <button class="revisego" type="submit" disabled>确定</button>
                <button class="revisenone" style="margin-left:50px">取消</button>
            </div>
        </div>
      </form>
    
  </div>
  <script>
  //个人信息
  $('.simplenew').click(function(){
      $('.modelsimple')[0].style.display = "block"
  })
  $('.simplex').click(function(){
      $('.modelsimple')[0].style.display = "none";
      $('input[name = resetpwd]').innerHTML = '';
  })
  $("input[name=simplehead]").change(function(){   
      console.log($("input[name=simplehead]"))
      var file = this.files[0];
      console.log(file.size)
      var maxsize = 1*1024*1024
          if(file.size > maxsize){
              $('.simplep')[0].innerHTML = "图片尺寸超过1MB 请另选图片";
                              setTimeout(function(){
                                  $('.simplep')[0].innerHTML = "";
                              },3000);
              
              $('.simplego').attr('disabled','disabled');
              return
          }else if (window.FileReader) {    
              
                  var reader = new FileReader();    
                  reader.readAsDataURL(file);    
                  //监听文件读取结束后事件    
                  reader.onloadend = function (e) {
                      console.log(e.target)
                      
                  $(".headimg").attr("src",e.target.result);
                  $('.simplego').attr('disabled',false);    //e.target.result就是最后的路径地址
                  };    
              } 
      });
      var form = new FormData(document.getElementById("simple"));

       $.ajax({
           url:"hetong.php",
           type:"post",
           data:form,
           processData:false,
           contentType:false,
           success:function(data){
               if(data == 1){
                  $('.simplep')[0].innerHTML = "保存成功"; 
               }else{
                  $('.simplep')[0].innerHTML = "保存失败";
               }
              },
          error:function(){
              $('.simplep')[0].innerHTML = "服务器错误";
          }
       })
  //重置密码
  function optnme(q){
      var arr1 = [];
      var arr2 = [];
      var objopt = {}
      for (let i = 0; i < q[0].length; i++) {
          arr1.push( q[0][i].value);
          arr2.push(q[0][i].innerHTML);
          
      }
     for (var j = 0; j < arr1.length; j++) {
         objopt[arr1[j]] = arr2[j]
         
     }
     return objopt
  }
  console.log(optnme($('select[name=resetaccount]')))
  var objopt2 = optnme($('select[name=resetaccount]'))
  $('input[name=resetname]').on('keyup',function(){
      $('select[name=resetaccount]')[0].innerHTML = ""
      for(var k in objopt2){
          if(objopt1[k].indexOf($('input[name=resetname]').val())> -1){
              $('select[name=resetaccount]')[0].innerHTML += "<select name='resetaccount' style='width:62%'>"
                  +"<option value="+k+">"+objopt2[k]+"</option>"+"</select>"
          }
      }
  })
  $('.resetnew').click(function(){
      $('.modelreset')[0].style.display = "block"
  })
  $('.resetx').click(function(){
      $('.modelreset')[0].style.display = "none";
      $('input[name = resetpwd]').innerHTML = '';
      event.preventDefault();
      
  })
  $('.resetwen').click(function(){
      $('.resethid')[0].style.display = "block";
      event.preventDefault();
  })
  $('.resetnone').click(function(){
      $('.resethid')[0].style.display = "none";
      event.preventDefault();
  })
  $('.reset').on('change',function(){
      if($('select[name=resetaccount]').val()!= ""){
          $('.resetgo').attr('disabled',false)
      }else{
          $('.resetgo').attr('disabled','disabled')
      }
  })


  //目标设定
  var objopt3 = optnme($('select[name=targetaccount]'))
  $('input[name=targetname]').on('keyup',function(){
      $('select[name=targetaccount]')[0].innerHTML = ""
      for(var k in objopt3){
          if(objopt3[k].indexOf($('input[name=targetname]').val())> -1){
              
              $('select[name=targetaccount]')[0].innerHTML += "<select name='targrtaccount' style='width:62%'>"
                  +"<option value="+k+">"+objopt3[k]+"</option>"+"</select>"
          }
      }
  })
  $('.targetnew').click(function(){
      $('.modeltarget')[0].style.display = "block"
  })
  $('.targetx').click(function(){
      $('.modeltarget')[0].style.display = "none";
      $('input[name = targetname]').innerHTML = '';
      $('input[name = targetmoney]').innerHTML = '';
      event.preventDefault();
  })
  var regtarget =  /^[0-9]*$/;
  $('input[name=targetmoney]').on('keyup',function(){
      if(regtarget.test($('input[name=targetmoney]').val())){
          $('input[name=targetmoney]')[0].style.color = "green";
      }else{
          $('input[name=targetmoney]')[0].style.color = "red";
      }
  })
  $('.targetwen').click(function(){
      $('.targethid')[0].style.display = "block";
      event.preventDefault();
  })
  $('.targetnone').click(function(){
      $('.targethid')[0].style.display = "none";
      event.preventDefault();
  })
  $('.target').on('change',function(){
      if($('select[name=targetaccount]').val() != ""&& $('input[name=targetmoney]')[0].style.color == "green"){
          $('.targetgo').attr('disabled',false)
      }else{
          $('.targetgo').attr('disabled','disabled')
      }
  })

  
  //流转过程
  $('.circulnew').click(function(){
      $('.modelcircul')[0].style.display = "block"
  })
  $('.circulx').click(function(){
      $('.modelcircul')[0].style.display = "none";
      $('input[name = searchnumber]').innerHTML = '';
  })
  var regnumber = /^1[3|4|5|7|8][0-9]{9}$/;
  
  $('input[name = searchnumber]').on('keyup',function(){
      if(regnumber.test($('input[name = searchnumber]').val())){
          $('input[name=searchnumber]')[0].style.color = "green";
      }else{
          $('input[name=searchnumber]')[0].style.color = "red";
      }
  })
  $('.circulgo').click(function(){
      $('.circulrcontent')[0].style.border = "1px solid #42b983"
      $('.circulrcontent')[0].style.borderRadius = "5px"
      $('.circulrcontent')[0].style.padding = "10px"
      if($('input[name=searchnumber]')[0].style.color == "green"){
          $.ajax({
              type:'POST', 
              url:'checkTel.php',
              data:{phoneNumer:$('input[name = searchnumber]').val()},
              success:function(data){
                  if(data == ""){
                      $('.circulrcontent')[0].innerHTML += "查询结果为空";
                      setTimeout(function(){
                      $('.circulrcontent')[0].innerHTML = "";
                      $('.circulrcontent')[0].style.border = ""
                      $('.circulrcontent')[0].style.borderRadius = ""
                      $('.circulrcontent')[0].style.padding = ""
                      },3000) 
                  }else{
                      for(var k in data){
                           $('.circulrcontent')[0].innerHTML += "<p>"+"项目名称："+data[k].project+"</p>"+"<p>"+"项目流转："+data[k].data_transfer+"</p>";        
                      }                 
                  }
              },
              error:function(){
                  $('.circulrcontent')[0].innerHTML = "服务器错误"; 
                  setTimeout(function(){
                  $('.circulrcontent')[0].innerHTML = "";
                  $('.circulrcontent')[0].style.border = ""
                  $('.circulrcontent')[0].style.borderRadius = ""
                  $('.circulrcontent')[0].style.padding = ""
                  },3000) 
              }
          })
      }else{
          $('.circulrcontent')[0].innerHTML = "请输入正确的手机号";   
              setTimeout(function(){
                  $('.circulrcontent')[0].innerHTML = "";
                  $('.circulrcontent')[0].style.border = ""
                  $('.circulrcontent')[0].style.borderRadius = ""
                  $('.circulrcontent')[0].style.padding = ""
              },3000)  
      }
  })

  
  //用户删除
  var objopt1 = optnme($('select[name=delaccount]'))
  $('input[name=delname]').on('keyup',function(){
      $('select[name=delaccount]')[0].innerHTML = ""
      for(var k in objopt1){
          if(objopt1[k].indexOf($('input[name=delname]').val())> -1){
              $('select[name=delaccount]')[0].innerHTML += "<select name='delaccount' style='width:62%'>"
                  +"<option value="+k+">"+objopt1[k]+"</option>"+"</select>"
          }
      }
  })
  $('.delnew').click(function(){
      $('.modeldel')[0].style.display = "block"
  })
  $('.delx').click(function(){
      $('.modeldel')[0].style.display = "none";
      $('input[name = delname]').innerHTML = '';
      event.preventDefault();
  })
  $('.delwen').click(function(){
      $('.delhid')[0].style.display = "block";
      event.preventDefault();
  })
  $('.delnone').click(function(){
      $('.delhid')[0].style.display = "none";
      event.preventDefault();
  })
  $('.delto').on('change',function(){
      if($('select[name=delaccount]').val() != ""){
          $('.delgo').attr('disabled',false)
      }else{
          $('.delgo').attr('disabled','disabled')
      }
  })

  //修改密码
  $('.revisenew').click(function(){
      $('.modelrevise')[0].style.display = "block"
  })
  $('.revisex').click(function(){
      $('.modelrevise')[0].style.display = "none";
      event.preventDefault();
      
  })
  $('.revisewen').click(function(){
      $('.revisehid')[0].style.display = "block";
      event.preventDefault();
  })
  $('.revisenone').click(function(){
      $('.revisehid')[0].style.display = "none";
      event.preventDefault();
  })
  var regrevise =  /^[0-9a-zA-Z_]{6,}$/;
  $('input[name=oldpwd]').on('keyup',function(){
      if(!regrevise.test($('input[name=oldpwd]').val())){
          $('input[name=oldpwd]')[0].style.color = "red";
      }else{
          $('input[name=oldpwd]')[0].style.color = "green";
          
      }
  })
  $('input[name=newpwd]').on('keyup',function(){
      if(!regrevise.test($('input[name=newpwd]').val())){
          $('input[name=newpwd]')[0].style.color = "red";
      }else{
          $('input[name=newpwd]')[0].style.color = "green";
          
      }
      if($('input[name=againnewpwd]').val() != $('input[name=newpwd]').val()){
          $('input[name=againnewpwd]')[0].style.color = "red";
      }else{
          $('input[name=againnewpwd]')[0].style.color = "green";
          
      }
  })
  $('input[name=againnewpwd]').on('keyup',function(){
      if($('input[name=againnewpwd]').val() != $('input[name=newpwd]').val()){
          $('input[name=againnewpwd]')[0].style.color = "red";
      }else{
          $('input[name=againnewpwd]')[0].style.color = "green";
          
      }
  })
  $('.revise').on('change',function(){
      if($('input[name=againnewpwd]')[0].style.color == "green"
      &&  $('input[name=newpwd]')[0].style.color == "green"
      &&  $('input[name=oldpwd]')[0].style.color == "green"){
          $('.revisego').attr('disabled',false)
      }else{
          $('.revisego').attr('disabled','disabled')
      }
  })
</script>